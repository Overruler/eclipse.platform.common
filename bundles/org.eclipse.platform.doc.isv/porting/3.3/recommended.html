<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta name="copyright" content="Copyright (c) IBM Corporation and others 2007. This page is made available under license. For full details see the LEGAL in the documentation book that contains this page." >
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="STYLESHEET" href="../../book.css" charset="ISO-8859-1" type="text/css">
<title>Adopting 3.3 mechanisms and APIs</title>
</head>

<body>

<h2>Adopting 3.3 mechanisms and APIs</h2>
<p>This section describes changes that are required if you are trying to change 
  your 3.2 plug-in to adopt the 3.3 mechanisms and APIs.</p>
  
<ol>
  <li><a href="#AppModel">Application model changes</a></li>
  <li><a href="#ContextLaunch">Launch selection versus launch last</a></li>
  <li><a href="#HyperlinkDetector">Replacing a hard-coded <code>IHyperlinkDetector</code> 
    with an extension</a></li>
  <li><a href="#FileBufferPerformance">Improve performance when working with file 
    buffers</a></li>
  <li><a href="#LaunchDelegate">Launch delegate names and descriptions</a></li>
</ol>
<hr>

<!-- ############################################## -->
<h2><a name="AppModel">1. Application model changes</a></h2>
<p>The Eclipse application container has been moved from <b>org.eclipse.core.runtime</b> 
into the new bundle <b>org.eclipse.equinox.app</b>. The Eclipse application container included in the 
org.eclipse.equinox.app bundle implements the Application Admin Service specification from the OSGi R4 specification.  
</p>
<p>
The following extension points have also been moved into the org.eclipse.equinox.app bundle. Note that
the fully qualified extension point ids are unchanged:
<ul>
 <li>org.eclipse.core.runtime.applications</li>
 <li>org.eclipse.core.runtime.products</li>
</ul>
The interface <b>org.eclipse.core.runtime.IPlatformRunnable</b> has been deprecated and the 
org.eclipse.equinox.app.IApplication interface should be used instead.  IPlatformRunnable is supported for 
backwards compatibility, and clients are encouraged to move to the new IApplication API
instead.
<p></p>
<p>
As a result of the code move, custom configurations and scripts that explicitly 
reference <b>org.eclipse.core.runtime</b> might need to add the <b>org.eclipse.equinox.app</b> bundle.
</p>
<p>See <a href="https://bugs.eclipse.org/bugs/show_bug.cgi?id=1109893">bug 109893</a> 
  for more details. </p> 
<!-- ############################################## -->
<p>&nbsp;</p>
<h2><a name="ContextLaunch">2. Launch selection versus launch last</a></h2>
<p>By default, running and debugging applications has been simplified to run or 
  debug the selected file or active editor. When the selected resource (or active 
  editor) is not executable, users can opt to launch the associated project or 
  re-launch the previous launch. These settings are managed on the <strong>Run/Debug 
  &gt; Launching</strong> preference page. Users can also revert to the 3.2 behavior 
  of always launching the previous application.</p>
<p>Pressing the <strong>Run</strong> or <strong>Debug</strong> toolbar button 
  will launch the selected resource (as will the <strong>Run</strong> or <strong>Debug</strong> 
  action in the top level Run menu). When no launch configuration exists for a 
  file and there is only one way to launch it, the file will simply be launched 
  in the mode selected. When there is more than one way to launch a file, the 
  user will be prompted to select how to run or debug the application. For example, 
  when running a JUnit test it can be run as a Java application or JUnit test. 
  A launch configuration will be created and an entry will be added to the launch 
  history for the application. When the same resource is launched again, it will 
  use the most recent configuration in the launch history associated with that 
  resource.</p>
<p>The underlying infrastructure for selection based launching relies on the launch 
  shortcuts applicable to a resource (or editor) and the resource mappings associated 
  with existing launch configurations. As well, API (a new extension element) 
  has been added to the <code>launchShortcuts</code> extension to associate a 
  launch shortcut with one or more types of launch configurations. For example, 
  this tells the platform that the &quot;Java Application&quot; launch shortcut 
  is associated with &quot;Java Application&quot; launch configurations.</p>
<p>The contextual launch support uses the following approach to determine how 
  a selection or active editor should be launched.</p>
<ol>
  <li>An <code>IResource</code> adapter is retrieved from the selection or active 
    editor (which can be <code>null</code>).</li>
  <li>A set of applicable launch configuration types are computed from the set 
    of launch shortcuts applicable to the selection/editor (using the new launch 
    configuration type elements defined by launch shortcuts).</li>
  <li>A set of applicable launch configurations is computed based on the launch 
    configuration types applicable to the selection/editor and the existing launch 
    configurations in the workspace.</li>
  <li>The set of applicable launch configurations is reduced to those that have 
    a resource mapping equal to or contained by the retrieved resource adapter</li>
  <li>The set of applicable launch configurations is compared to the launch history 
    and the most recently launched configuration in the set is selected for launching.</li>
  <li>When there are applicable launch configurations, but none are in the recent 
    launch history, the user is prompted to select one of the applicable configurations 
    to launch.</li>
  <li>When there are applicable launch shortcuts and no applicable launch configurations, 
    the user is prompted on how they want to launch the selection (i.e. which 
    shortcut they want to use).</li>
</ol>
<p>When there are no applicable launch configurations or launch shortcuts, the 
  platform either attempts to launch the associated project or launches last, 
  based on user preference settings. When the user has chosen to launch the associated 
  project, the same steps as above are followed, except the resource used is the 
  project.</p>
<p>For selection based launching to work well, plug-in providers should ensure 
  the following.</p>
<ol>
  <li>Resource mappings for launch configurations should be scoped to the appropriate 
    resource. For example, to support projects with multiple Java executables, 
    Java application launch configurations are associated with the the .java file 
    containing the main class.</li>
  <li>Launch shortcut extensions should be updated with <code>configurationType</code> 
    elements so the platform can infer which launch configuration types to consider 
    when resolving launch configurations applicable to a selection/editor.</li>
  <li>Launch configuration migration delegates should be updated to create appropriate 
    resource mappings for existing launch configurations. For example, if launch 
    your launch configuration resource mappings in 3.2 were always associated 
    with a project, but now you want to associated them with specific files in 
    a project to better support context launching, your migration delegate should 
    be updated to update resource mappings.</li>
</ol>
<!-- ############################################## -->
<p>&nbsp;</p>
<h2><a name="HyperlinkDetector">3. Replacing a hard-coded <code>IHyperlinkDetector</code> with an extension</a></h2>
Before 3.3 it was not possible to contribute hyperlink detectors to existing source viewers and textual editors. Only
their implementors could add them directly through code by providing their hyper link detectors via
<code>SourceViewerConfiguration.getHyperlinkDetectors(ISourceViewer)</code>.
<p>
As of 3.3, clients can define hyperlink detector targets for their viewers and editors and they can contribute
their own hyperlink detectors to such targets via the following extension points:
<ul>
	<li><a href="../../reference/extension-points/org_eclipse_ui_workbench_texteditor_hyperlinkDetectorTargets.html">org.eclipse.ui.workbench.texteditor.hyperlinkDetectorTargets</a></li>
	<li><a href="../../reference/extension-points/org_eclipse_ui_workbench_texteditor_hyperlinkDetectors.html">org.eclipse.ui.workbench.texteditor.hyperlinkDetectors</a></li>
</ul>
<!-- ############################################## -->
<p>&nbsp;</p>
<h2><a name="FileBufferPerformance">4. Improve performance when working with file buffers</a></h2>
In earlier versions file buffer manager API methods used to take an <code>IPath</code> and it was
up to the file buffer manager to detect whether that path pointed to a workspace or an external location.
Those API methods have been deprecated in 3.3 in order to improve performance as in most cases clients already
know whether their path is a workspace path or an external path. New methods with same names have been
that take one of the following location kind arguments:
<ul>
  <li><a href="../../reference/api/org/eclipse/core/filebuffers/LocationKind.html#IFILE">IFile</a></li>
  <li><a href="../../reference/api/org/eclipse/core/filebuffers/LocationKind.html#LOCATION">LOCATION</a></li>
  <li><a href="../../reference/api/org/eclipse/core/filebuffers/LocationKind.html#NORMALIZE">NORMALIZE</a></li>
</ul>
<!-- ############################################## -->
<p>&nbsp;</p>
<h2><a name="LaunchDelegate">5. Launch delegate names and descriptions</a></h2>
<p>New attributes have been added to the <code>launchConfigurationTypes</code> 
  and <code>launchDelegates</code> extension points to provide names and descriptions 
  for launch delegates. Since 3.3, the debug platform allows for more than one 
  launcher to be contributed for the same kind of launch configuration type and 
  launch mode. When more than one launcher is available the user must choose a 
  preferred launcher and is presented with names and descriptions of available 
  launchers. Clients contributing launch delegates with either of these extension 
  points are encouraged to provide meaningful names and descriptions.</p>
<p>Clients contributing to the <code>org.eclipse.debug.core.launchConfigruationTypes</code> 
  extension point should define the following new attributes:</p>
<ul>
  <li><code>delegateName</code></li>
  <li><code>delegateDescription</code></li>
</ul>
<p>Clients contributing to the <code>org.eclipse.debug.core.launchDelegates </code>extension 
  point should define the following new attributes:</p>
<ul>
  <li><code>name</code></li>
  <li><code>delegateDescription</code></li>
</ul>
</body>
</html>
